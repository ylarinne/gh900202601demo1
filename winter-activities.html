<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winter Holiday Activities</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-blue-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold text-center text-blue-900 mb-8">Winter Holiday Activities</h1>
        
        <!-- Filter Controls -->
        <div class="mb-6 flex flex-wrap gap-4 justify-center">
            <button id="filter-all" class="px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 transition-colors">
                All Activities
            </button>
            <button id="filter-snow" class="px-6 py-2 rounded-lg bg-white text-blue-600 font-semibold hover:bg-blue-50 transition-colors border-2 border-blue-600">
                ‚ùÑÔ∏è Snow Required
            </button>
            <button id="filter-no-snow" class="px-6 py-2 rounded-lg bg-white text-green-600 font-semibold hover:bg-green-50 transition-colors border-2 border-green-600">
                ‚úì No Snow Needed
            </button>
            <button id="filter-free" class="px-6 py-2 rounded-lg bg-white text-purple-600 font-semibold hover:bg-purple-50 transition-colors border-2 border-purple-600">
                üí∞ Free Activities
            </button>
        </div>
        
        <div id="activities-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Activities will be rendered here -->
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:3000/api/activities';
        let allActivities = [];
        let currentFilter = 'all';

        async function fetchActivities() {
            try {
                const response = await fetch(API_URL);
                if (!response.ok) {
                    throw new Error('Failed to fetch activities');
                }
                allActivities = await response.json();
                renderActivities(allActivities);
            } catch (error) {
                console.error('Error fetching activities:', error);
                const container = document.getElementById('activities-container');
                container.innerHTML = `
                    <div class="col-span-full text-center p-8">
                        <p class="text-red-600 text-xl">Failed to load activities. Please make sure the server is running.</p>
                        <p class="text-gray-600 mt-2">Run: npm start</p>
                    </div>
                `;
            }
        }

        function renderActivities(winterActivities) {
            const container = document.getElementById('activities-container');
            container.innerHTML = ''; // Clear existing content
            
            if (winterActivities.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center p-8">
                        <p class="text-gray-600 text-xl">No activities found for this filter.</p>
                    </div>
                `;
                return;
            }
            
            winterActivities.forEach(activity => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow duration-300';
                
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <h2 class="text-2xl font-semibold text-gray-800">${activity.name}</h2>
                        <span class="text-xs px-2 py-1 rounded-full ${activity.isSnowNeeded ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'}">
                            ${activity.isSnowNeeded ? '‚ùÑÔ∏è Snow Required' : '‚úì No Snow Needed'}
                        </span>
                    </div>
                    <div class="text-3xl font-bold text-blue-600">
                        ${activity.price === 0 ? 'FREE' : `$${activity.price}`}
                    </div>
                    <p class="text-sm text-gray-500 mt-2">Activity ID: ${activity.id}</p>
                `;
                
                container.appendChild(card);
            });
        }

        function applyFilter(filter) {
            currentFilter = filter;
            let filtered = [];

            switch(filter) {
                case 'snow':
                    filtered = allActivities.filter(a => a.isSnowNeeded === true);
                    break;
                case 'no-snow':
                    filtered = allActivities.filter(a => a.isSnowNeeded === false);
                    break;
                case 'free':
                    filtered = allActivities.filter(a => a.price === 0);
                    break;
                default:
                    filtered = allActivities;
            }

            renderActivities(filtered);
            updateActiveButton(filter);
        }

        function updateActiveButton(filter) {
            // Remove active state from all buttons
            document.querySelectorAll('button[id^="filter-"]').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'bg-green-600', 'bg-purple-600', 'text-white');
                btn.classList.add('bg-white');
                
                if (btn.id === 'filter-snow') {
                    btn.classList.add('text-blue-600', 'border-blue-600');
                } else if (btn.id === 'filter-no-snow') {
                    btn.classList.add('text-green-600', 'border-green-600');
                } else if (btn.id === 'filter-free') {
                    btn.classList.add('text-purple-600', 'border-purple-600');
                } else {
                    btn.classList.add('text-blue-600', 'border-blue-600');
                }
            });

            // Add active state to current button
            const activeBtn = document.getElementById(`filter-${filter}`);
            if (activeBtn) {
                activeBtn.classList.remove('bg-white');
                
                if (filter === 'snow') {
                    activeBtn.classList.add('bg-blue-600', 'text-white');
                    activeBtn.classList.remove('text-blue-600');
                } else if (filter === 'no-snow') {
                    activeBtn.classList.add('bg-green-600', 'text-white');
                    activeBtn.classList.remove('text-green-600');
                } else if (filter === 'free') {
                    activeBtn.classList.add('bg-purple-600', 'text-white');
                    activeBtn.classList.remove('text-purple-600');
                } else {
                    activeBtn.classList.add('bg-blue-600', 'text-white');
                    activeBtn.classList.remove('text-blue-600');
                }
            }
        }

        // Setup filter event listeners
        document.getElementById('filter-all').addEventListener('click', () => applyFilter('all'));
        document.getElementById('filter-snow').addEventListener('click', () => applyFilter('snow'));
        document.getElementById('filter-no-snow').addEventListener('click', () => applyFilter('no-snow'));
        document.getElementById('filter-free').addEventListener('click', () => applyFilter('free'));

        // Fetch and render activities when page loads
        fetchActivities();
    </script>
</body>
</html>